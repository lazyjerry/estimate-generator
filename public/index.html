<!DOCTYPE html>
<html lang="zh-TW">
	<head>
		<meta charset="UTF-8" />
		<title>報價單產生器</title>
		<!-- Bootstrap CSS CDN -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<link href="/main.css" rel="stylesheet" />
	</head>

	<body>
		<div class="container my-4">
			<h1 class="text-center mb-4">報價單產生器</h1>
			<!-- method="POST" 只是示例，實際動作需搭配後端設定 -->
			<form id="quoteForm" method="POST" target="_blank" action="/quote">
				<!-- 隱藏欄位，用來存放整份 JSON 資料 -->
				<input type="hidden" name="data" id="dataField" />
				<div class="row">
					<!-- 左側：基本資料 -->
					<div class="col-md-6">
						<div class="mb-3">
							<label for="logoUrl" class="form-label"
								>Logo URL（請注意 CORS 問題）</label
							>
							<input
								type="text"
								class="form-control"
								id="logoUrl"
								name="logoUrl"
								placeholder="例如：https://example.com/logo.png"
								value=""
							/>
						</div>
						<div class="mb-3">
							<label for="providerName" class="form-label"
								>乙方 (報價單位)</label
							>
							<input
								type="text"
								class="form-control"
								id="providerName"
								name="providerName"
								placeholder="例如：乙方示例公司"
								required
							/>
						</div>
						<div class="mb-3">
							<label for="providerContact" class="form-label"
								>乙方聯絡資訊</label
							>
							<textarea
								class="form-control"
								id="providerContact"
								name="providerContact"
								rows="3"
								placeholder="請輸入資訊，例如：&#10;地址：台中市西區示例路 10 號&#10;電話：04-1234567"
								required
							></textarea>
						</div>
						<div class="mb-3">
							<label for="customerName" class="form-label">甲方 (客戶)</label>
							<input
								type="text"
								class="form-control"
								id="customerName"
								name="customerName"
								placeholder="例如：甲方示例企業"
								required
							/>
						</div>
						<div class="mb-3">
							<label for="customerContact" class="form-label"
								>甲方聯絡資訊</label
							>
							<textarea
								class="form-control"
								id="customerContact"
								name="customerContact"
								rows="3"
								placeholder="請輸入資訊，例如：&#10;地址：高雄市前鎮區示例路 20 號&#10;電話：07-7654321"
								required
							></textarea>
						</div>
						<div class="mb-3">
							<label for="quoteNumber" class="form-label">報價單編號</label>
							<input
								type="text"
								class="form-control"
								id="quoteNumber"
								name="quoteNumber"
								required
							/>
						</div>
						<div class="mb-3">
							<label for="dateInput" class="form-label">日期</label>
							<input
								type="date"
								class="form-control"
								id="dateInput"
								name="date"
								required
							/>
						</div>
						<div class="mb-3">
							<label for="deadlineInput" class="form-label">截止日期</label>
							<input
								type="date"
								class="form-control"
								id="deadlineInput"
								name="deadline"
								required
							/>
						</div>
						<div class="mb-3">
							<label for="remarks" class="form-label">備註</label>
							<textarea
								class="form-control"
								id="remarks"
								name="remarks"
								rows="12"
								placeholder="例如：此報價僅供參考，請儘快回覆"
							>
1.該份報價附屬於事先簽署的合作合約之中，若無則僅供確認記錄留存，請勿蓋章、回簽。
2.單價不含稅與支付平台手續費用。發票稅為總價 5%，其餘手續費用另記。
3.頭款與其他款項需另行確認，並於頭款支付完成後開始執行。
4.尾款支付期為於結案後 7 天內，或於執行前另外約定，遲延給付一日 0.1% 違約金。
5.我方得以於不涉及甲方營業秘密原則下，保留該作品作為作品集展示之權利。
6.如規格有異動，需調整報價請另行提出。</textarea
							>
						</div>
					</div>
					<!-- 右側：品項明細與金額 -->
					<div class="col-md-6">
						<h2>品項細節</h2>
						<table class="table table-bordered" id="itemsTable">
							<tbody>
								<!-- 此處預設不放任何<tr>，直接靠JS動態插入 -->
							</tbody>
						</table>
						<!-- 新增品項 + 刷新 按鈕組（刷新按鈕置右，正方形） -->
						<div class="d-flex mb-3">
							<button type="button" id="addItemButton" class="btn btn-primary">
								＋ 新增品項
							</button>
							<!-- ms-auto 表示往左推，讓按鈕跑到最右邊 -->
							<button
								type="button"
								id="refreshButton"
								class="btn btn-secondary ms-auto d-flex align-items-center justify-content-center"
								style="width: 40px; height: 40px"
								title="刷新"
							>
								↺
							</button>
						</div>
						<div class="mb-3 mt-3">
							<label for="taxPercent" class="form-label">稅金百分比 (%)</label>
							<input
								type="number"
								class="form-control"
								id="taxPercent"
								name="taxPercent"
								step="1"
								min="0"
								value="0"
								required
							/>
						</div>
						<!-- Totals 以兩行表格呈現 -->
						<table class="table table-bordered text-center mt-3">
							<tr>
								<th>小計</th>
								<th>稅金</th>
								<th>總計</th>
							</tr>
							<tr>
								<td id="subtotalDisplay">0</td>
								<td id="taxDisplay">0</td>
								<td id="totalDisplay">0</td>
							</tr>
						</table>
					</div>
				</div>
				<!-- 浮動的圓形提交按鈕 -->
				<button
					type="submit"
					id="submitButton"
					class="btn btn-success rounded-circle position-fixed"
				>
					&#10003;
				</button>
				<!-- 小型圓形：匯出JSON、匯入JSON -->
				<button
					type="button"
					class="fab-sub"
					id="exportJsonBtn"
					onclick="exportFormJSON()"
					title="匯出 JSON"
				>
					JSON匯出
				</button>
				<button
					type="button"
					class="fab-sub"
					id="importJsonBtn"
					onclick="document.getElementById('importJsonFile').click()"
					title="匯入 JSON"
				>
					JSON匯入
				</button>
				<!-- 隱藏檔案欄位，供匯入 JSON -->
				<input
					type="file"
					id="importJsonFile"
					style="display: none"
					accept=".json"
					onchange="importFormJSON(event)"
				/>
			</form>
		</div>
		<!-- 隱藏的品項模板：數量、單價、刪除 都在同一行 -->
		<script type="text/template" id="itemTemplate">
			<tr class="descRow">
			  <td colspan="3">
			    <textarea
			      class="form-control"
			      name="itemDescription"
			      placeholder="品項描述"
			      rows="3"
			      required
			    ></textarea>
			  </td>
			</tr>
			<tr class="numberRow">
			  <td>
			    <label class="form-label">數量</label>
			    <input
			      type="number"
			      class="form-control"
			      name="itemQuantity"
			      step="1"
			      min="1"
			      value="1"
			      required
			    />
			  </td>
			  <td>
			    <label class="form-label">單價</label>
			    <input
			      type="number"
			      class="form-control"
			      name="itemUnitPrice"
			      step="1"
			      min="0"
			      value="0"
			      required
			    />
			  </td>
			  <td class="delete-cell align-middle">
			    <button
			      type="button"
			      class="btn btn-danger btn-sm"
			      onclick="removeRow(this)"
			      title="刪除"
			    >
			      X
			    </button>
			  </td>
			</tr>
		</script>
		<!-- jQuery CDN -->
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<!-- Bootstrap JS CDN -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<!-- FileSaver.js 用於下載 JSON -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
		<script src="/func.js"></script>
		<script src="/main.js"></script>
	</body>
</html>
